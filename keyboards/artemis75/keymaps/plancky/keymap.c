#include QMK_KEYBOARD_H

enum layer_names {
    _COLEMAK,
    _FN1,
    _FN2,
    _FN3
};

// Tap dance keycodes
enum td_keycodes {
    TD_ESC_CAPS
};

enum unicode_names {
    DEG, TIMES, LEFT, DOWN, UP, RIGHT, COPY, SQUARED, PLUSMIN, ENDASH, EQUISH,
    NEQ, LEQ, GEQ
};

const uint32_t PROGMEM unicode_map[] = {
    [DEG]     = 0x00B0,  // °
    [TIMES]   = 0x00D7,  // ×
    [LEFT]  = 0x2190,  // ←
    [UP]    = 0x2191,  // ↑
    [DOWN]  = 0x2193,  // ↓
    [RIGHT] = 0x2192,  // →
    [COPY]  = 0x00A9,  // ©
    [SQUARED] = 0x00B2,  // ²
    [PLUSMIN] = 0x00B1,  // ±
    [ENDASH]  = 0x2013,  // –
    [EQUISH]  = 0x2248,  // ≈
    [NEQ]   = 0x2260,  // ≠
    [LEQ]   = 0x2264,  // ≤
    [GEQ]   = 0x2265,  // ≥
};

const uint16_t PROGMEM keymaps[][MATRIX_ROWS][MATRIX_COLS] = {
    /*
     * ┌────┬────┬────┬────┬────┬────┬────┬────┬────┬────┬────┬────┬────┬────┬────┐
     * │ ESC│    │    │    │    │    │    │    │    │    │    │    │    │    │RSET│
     * ├────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┤
     * │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    │
     * ├────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┤
     * │ TAB│  Q │  W │  F │  P │  G │  J │  L │  U │  Y │  ; │ ESC│    │    │    │
     * ├────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┴────┼────┤
     * │  _ │  A │  R │  S │  T │  D │  H │  N │  E │  I │  O │  ' │         │    │
     * ├────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┬────┼────┤
     * │BKSP│  Z │  X │  C │  V │  B │  K │  M │  , │  . │  / │ENTR│    │    │    │
     * ├────┼────┼────┼────┼────┴────┼────┴────┼────┼────┼────┼────┼────┼────┼────┤
     * │CTRL│LALT│ GUI│D/F2│  SHIFT  │SPACE/FN3│ FN1│LEFT│DOWN│ UP │RGHT│    │    │
     * └────┴────┴────┴────┴─────────┴─────────┴────┴────┴────┴────┴────┴────┴────┘
     */
    [_COLEMAK] = LAYOUT(  /* Colemak layer -- base */
        KC_ESC,  _______, _______, _______, _______, _______,  _______, _______, _______,   _______, _______, _______,         _______,  _______, RESET,
        _______, _______, _______, _______, _______, _______,  _______, _______, _______,   _______, _______, _______,         _______,  _______, _______,
        KC_TAB,  KC_Q,    KC_W,    KC_F,    KC_P,    KC_G,     KC_J,   KC_L,     KC_U,      KC_Y,    KC_SCLN, TD(TD_ESC_CAPS), _______,  _______, _______,
        KC_UNDS, KC_A,    KC_R,    KC_S,    KC_T,    KC_D,     KC_H,   KC_N,     KC_E,      KC_I,    KC_O,    KC_QUOT,         _______,           _______,
        KC_BSPC, KC_Z,    KC_X,    KC_C,    KC_V,    KC_B,     KC_K,   KC_M,     KC_COMM,   KC_DOT,  KC_SLSH, KC_ENT,          _______,  _______, _______,
        KC_LCTL, KC_LALT, KC_LGUI, LT(_FN2, KC_DEL), KC_LSFT, LT(_FN3, KC_SPC), OSL(_FN1), KC_LEFT, KC_DOWN, KC_UP,           KC_RIGHT, _______, _______
    ),
    /*
     * ┌────┬────┬────┬────┬────┬────┬────┬────┬────┬────┬────┬────┬────┬────┬────┐
     * │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    │
     * ├────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┤
     * │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    │
     * ├────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┤
     * │  ` │    │    │    │    │  - │    │WH_L│WH_D│WH_U│WH_R│SLEP│    │    │    │
     * ├────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┴────┼────┤
     * │  - │  [ │  ] │  ( │  ) │  = │    │LEFT│DOWN│ UP │RGHT│  \ │         │    │
     * ├────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┬────┼────┤
     * │    │  { │  } │TABL│TABR│  + │    │HOME│PGDN│PGUP│ END│    │    │    │    │
     * ├────┼────┼────┼────┼────┴────┼────┴────┼────┼────┼────┼────┼────┼────┼────┤
     * │    │    │    │    │         │         │!!!!│WBAK│    │    │WFWD│    │    │
     * └────┴────┴────┴────┴─────────┴─────────┴────┴────┴────┴────┴────┴────┴────┘
     */
    [_FN1] = LAYOUT(  /* RAISE (RIGHT) FUNCTION LAYER */
        _______, _______,    _______,    _______,    _______,    _______,   _______, _______, _______, _______, _______,  _______, _______,  _______, _______,
        _______, _______,    _______,    _______,    _______,    _______,   _______, _______, _______, _______, _______,  _______, _______,  _______, _______,
        KC_GRV,  _______,    _______,    _______,    _______,    KC_MINS,   _______, KC_WH_L, KC_WH_D, KC_WH_U, KC_WH_R,  KC_SLEP, _______,  _______, _______,
        KC_MINS, KC_LBRC,    KC_RBRC,    S(KC_9),    S(KC_0),    KC_EQL,    _______, KC_LEFT, KC_DOWN, KC_UP,   KC_RIGHT, KC_BSLS, _______,           _______,
        _______, S(KC_LBRC), S(KC_RBRC), C(KC_PGUP), C(KC_PGDN), S(KC_EQL), _______, KC_HOME, KC_PGDN, KC_PGUP, KC_END,   _______, _______,  _______, _______,
        _______, _______,    _______,    _______,    _______,               _______,          _______, KC_WBAK, _______,  _______, KC_WFWD, _______,  _______
    ),
    /*
     * ┌────┬────┬────┬────┬────┬────┬────┬────┬────┬────┬────┬────┬────┬────┬────┐
     * │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    │
     * ├────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┤
     * │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    │
     * ├────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┤
     * │  ~ │    │  & │  * │    │    │    │  7 │  8 │  9 │  0 │SLEP│    │    │    │
     * ├────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┴────┼────┤
     * │  – │    │  $ │  % │  ^ │    │    │  4 │  5 │  6 │    │  | │         │    │
     * ├────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┬────┼────┤
     * │    │    │  ! │  @ │  # │    │    │  1 │  2 │  3 │    │    │    │    │    │
     * ├────┼────┼────┼────┼────┴────┼────┴────┼────┼────┼────┼────┼────┼────┼────┤
     * │    │    │    │!!!!│         │         │    │MUTE│VOL-│VOL+│PLAY│    │    │
     * └────┴────┴────┴────┴─────────┴─────────┴────┴────┴────┴────┴────┴────┴────┘
     */
    [_FN2] = LAYOUT(  /* LOWER (LEFT) FUNCTION LAYER */
        _______,   _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______,    _______, _______, _______,
        _______,   _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______,    _______, _______, _______,
        S(KC_GRV), _______, S(KC_7), S(KC_8), _______, _______, _______, KC_7,    KC_8,    KC_9,    KC_0,    KC_SLEP,    _______, _______, _______,
        ENDASH,    _______, S(KC_4), S(KC_5), S(KC_6), _______, _______, KC_4,    KC_5,    KC_6,    _______, S(KC_BSLS), _______,          _______,
        _______,   _______, S(KC_1), S(KC_2), S(KC_3), _______, _______, KC_1,    KC_2,    KC_3,    _______, _______,    _______, _______, _______,
        _______,   _______, _______, _______, _______,          _______,          _______, KC_MUTE, KC_VOLD, KC_VOLU,    KC_MPLY, _______, _______
    ),
    /*
     * ┌────┬────┬────┬────┬────┬────┬────┬────┬────┬────┬────┬────┬────┬────┬────┐
     * │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    │
     * ├────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┤
     * │    │    │    │    │    │    │    │    │    │    │    │    │    │    │    │
     * ├────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┤
     * │    │    │  ≥ │  ± │  ≈ │    │    │ F7 │ F8 │ F9 │ F10│RSET│    │    │    │
     * ├────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┴────┼────┤
     * │    │    │  ≤ │  × │  ° │    │    │ F4 │ F5 │ F6 │    │    │         │    │
     * ├────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┬────┼────┤
     * │    │    │  © │  ² │  ≠ │    │    │ F1 │ F2 │ F3 │    │    │    │    │    │
     * ├────┼────┼────┼────┼────┴────┼────┴────┼────┼────┼────┼────┼────┼────┼────┤
     * │    │    │    │    │         │!!!!!!!!!│    │  ← │  ↓ │  ↑ │  → │    │    │
     * └────┴────┴────┴────┴─────────┴─────────┴────┴────┴────┴────┴────┴────┴────┘
     */
    [_FN3] = LAYOUT(  /* SPACE BAR (LAYER-TAP) FUNCTION LAYER */
        _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______,
        _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______,
        _______, _______, GEQ,     PLUSMIN, EQUISH,  _______, _______, KC_F7,   KC_F8,   KC_F9,   KC_F10,  RESET,   _______, _______, _______,
        _______, _______, LEQ,     TIMES,   DEG,     _______, _______, KC_F4,   KC_F5,   KC_F6,   _______, _______, _______,          _______,
        _______, _______, COPY,    SQUARED, NEQ,     _______, _______, KC_F1,   KC_F2,   KC_F3,   _______, _______, _______, _______, _______,
        _______, _______, _______, _______, _______,          _______,          _______, LEFT,    DOWN,    UP,      RIGHT,   _______, _______
    )
};

// Tap Dance Definitions
qk_tap_dance_action_t tap_dance_actions[] = {
  // Tap once for Esc, twice for Caps Lock
  [TD_ESC_CAPS]  = ACTION_TAP_DANCE_DOUBLE(KC_ESC, KC_CAPS)
// Other declarations would go here, separated by commas, if you have them
};

void matrix_init_user(void) {
    set_unicode_input_mode(UC_LNX);
}